# МАТРИЦА ОТНОШЕНИЙ: СТРАНИЦЫ, ПРИЗНАКИ И СУЩНОСТИ

## 1. СТРАНИЦЫ/РАЗДЕЛЫ ПРИЛОЖЕНИЯ

### 1.1. Ленты событий
- **explore (глобальная лента)** - `client/app/(tabs)/explore.tsx`
- **explore (лента друзей)** - `client/app/(tabs)/explore.tsx` (режим "Друзья")
- **memories (лента меморис постов)** - `client/app/(tabs)/memories.tsx`

### 1.2. Профиль пользователя
- **profile (свой профиль)** - `client/app/(tabs)/profile.tsx`
- **profile/[id] (чужой профиль)** - `client/app/profile/[id].tsx`
- **profile - раздел "Memories"** - внутри профиля, список прошедших событий
- **profile - раздел "Организовал"** - внутри профиля, список организованных событий
- **profile - раздел "Участвовал"** - внутри профиля, список событий, где пользователь участник
- **profile - параметр "всего событий" (шапка)** - счетчик в шапке профиля
- **profile - параметр "организовал" (шапка)** - счетчик в шапке профиля
- **profile - параметр "участвовал" (шапка)** - счетчик в шапке профиля
- **profile - параметр "разделил" (шапка)** - счетчик в шапке профиля

### 1.3. Списки событий (отдельные страницы)
- **all-events/[userId]** - все события пользователя
- **organized-events/[userId]** - организованные события пользователя
- **participated-events/[userId]** - события, где пользователь участник
- **shared-events/[userId]** - разделенные события пользователя

### 1.4. Карта
- **map (общая карта)** - `client/app/map.tsx` (все события)
- **map (персональная карта)** - `client/app/map.tsx` (события пользователя)

### 1.5. Календарь
- **calendar** - `client/app/calendar.tsx` (недельный календарь)

### 1.6. Страница события
- **event-profile/[id]** - профиль события (карточка события как шапка + меморис посты внизу). Повторяет все признаки карточки события.

### 1.7. Другие страницы
- **saved** - сохраненные события и посты
- **inbox** - входящие сообщения и запросы
- **create** - создание события

---

## 2. ПРИЗНАКИ/СОСТОЯНИЯ СОБЫТИЙ

### 2.1. Временные признаки
- **предстоящее** (`isEventUpcoming`) - событие еще не началось
- **прошедшее** (`isEventPast`) - событие уже завершилось

### 2.2. Признаки участия пользователя
- **я_организатор** (`isUserOrganizer`) - текущий пользователь является организатором события
- **я_участник** (`isUserAttendee`) - текущий пользователь является участником (ACCEPTED)
- **я_член_события** (`isUserEventMember`) - текущий пользователь является организатором ИЛИ участником
- **я_приглашен** (`getUserRelationship === 'invited'`) - пользователь получил приглашение
- **я_запросил_участие** (`getUserRequestStatus === 'pending'`) - пользователь отправил запрос на участие
- **я_отклонил_приглашение** (`getUserRequestStatus === 'rejected'` И `type === 'invite'`) - пользователь отклонил приглашение
- **я_отклонил_запрос** (`getUserRequestStatus === 'rejected'` И `type === 'join'`) - пользователь отклонил запрос на участие
- **я_не_член** (`getUserRelationship === 'non_member'`) - пользователь не является членом события
- **я_в_ожидании** (`getUserRelationship === 'waiting'`) - пользователь запланировал участие (waiting статус)

### 2.3. Статусы запросов/приглашений
- **organizer** - пользователь является организатором
- **accepted** - пользователь принял приглашение/запрос
- **pending** - запрос/приглашение в ожидании
- **rejected** - запрос/приглашение отклонено
- **not_requested** - запрос не отправлен
- **invited** - пользователь приглашен
- **waiting** - пользователь запланировал участие

### 2.4. Признаки события
- **заполнено** (`isEventFull`) - достигнут лимит участников
- **не_заполнено** (`isEventNotFull`) - есть свободные места
- **отменено** (`isCancelled`) - событие отменено организатором
- **удалено** - событие полностью удалено из базы
- **регулярное** (`isRecurring`) - событие повторяется

### 2.5. Социальные признаки
- **друг_организатора** (`isFriendOfOrganizer`) - текущий пользователь является другом организатора
- **не_друг_организатора** - текущий пользователь не является другом организатора

### 2.6. Признаки для MemoryPost
- **автор_поста_я** - текущий пользователь является автором меморис поста
- **автор_поста_друг** - автор меморис поста является другом текущего пользователя
- **автор_поста_не_друг** - автор меморис поста не является другом текущего пользователя
- **АВТОР_ПОСТА_УЧАСТНИК_НАШЕГО_РАЗДЕЛЕННОГО_СОБЫТИЯ** - автор поста и текущий пользователь являются участниками одного и того же события (не обязательно друзья)

---

## 3. СУЩНОСТИ

### 3.1. EventCard (Карточка события)
- Отображается в лентах событий
- Отображается в профиле пользователя
- Отображается в списках событий
- Отображается на карте (маркер)

### 3.2. MemoryPost (Меморис пост)
- Отображается в ленте Memories
- Отображается в профиле события (event-profile/[id]) - внизу под карточкой события
- Отображается в разделе Memories профиля пользователя

### 3.3. EventProfile (Профиль события)
- **ВАЖНО:** Профиль события - это просто страница, где карточка события (EventCard) становится шапкой, а внизу отображаются меморис посты (MemoryPost)
- Профиль события повторяет ВСЕ признаки и состояния карточки события
- Не требует отдельных признаков - использует те же, что и EventCard

---

## 4. МАТРИЦА ОТНОШЕНИЙ

### Формат заполнения:
```
СТРАНИЦА/РАЗДЕЛ | СУЩНОСТЬ | ПРИЗНАКИ (через запятую) | ПРИМЕЧАНИЯ
```

### Примеры:
```
explore (глобальная лента) | EventCard | предстоящее, не_заполнено, я_не_член, не_друг_организатора | Исключаются: rejected, accepted (кроме organizer)
explore (лента друзей) | EventCard | предстоящее, не_заполнено, друг_организатора, я_не_член | Исключаются: rejected
memories (лента) | MemoryPost | прошедшее, автор_поста_я_или_друг | Только друзья или я
profile - раздел Memories | EventCard | прошедшее, я_член_события | Прошедшие события, где пользователь участник или организатор
profile - параметр "организовал" | счетчик | предстоящее_или_прошедшее, я_организатор | Исключаются: rejected (только для участников)
event-profile/[id] | EventCard + MemoryPost | повторяет признаки карточки события | Карточка как шапка + посты внизу
```

---

## 5. ПУСТАЯ МАТРИЦА ДЛЯ ЗАПОЛНЕНИЯ

| СТРАНИЦА/РАЗДЕЛ | СУЩНОСТЬ | ПРИЗНАКИ | ПРИМЕЧАНИЯ |
|----------------|----------|----------|------------|
| | | | |
| | | | |
| | | | |
| | | | |
| | | | |
| | | | |
| | | | |
| | | | |
| | | | |
| | | | |
| | | | |
| | | | |
| | | | |
| | | | |
| | | | |
| | | | |
| | | | |
| | | | |
| | | | |
| | | | |
| | | | |
| | | | |

---

## 6. СПРАВОЧНИК ПРИЗНАКОВ (для копирования)

### Временные:
- предстоящее
- прошедшее

### Участие:
- я_организатор
- я_участник
- я_член_события
- я_приглашен
- я_запросил_участие
- я_отклонил_приглашение
- я_отклонил_запрос
- я_не_член
- я_в_ожидании

### Статусы:
- organizer
- accepted
- pending
- rejected
- not_requested
- invited
- waiting

### Событие:
- заполнено
- не_заполнено
- отменено
- удалено
- регулярное

### Социальные:
- друг_организатора
- не_друг_организатора
- автор_поста_я
- автор_поста_друг
- автор_поста_не_друг
- АВТОР_ПОСТА_УЧАСТНИК_НАШЕГО_РАЗДЕЛЕННОГО_СОБЫТИЯ

---

## 7. СПРАВОЧНИК СТРАНИЦ (для копирования)

### Ленты:
- explore (глобальная лента)
- explore (лента друзей)
- memories (лента меморис постов)

### Профиль:
- profile (свой профиль)
- profile/[id] (чужой профиль)
- profile - раздел "Memories"
- profile - раздел "Организовал"
- profile - раздел "Участвовал"
- profile - параметр "всего событий" (шапка)
- profile - параметр "организовал" (шапка)
- profile - параметр "участвовал" (шапка)
- profile - параметр "разделил" (шапка)

### Списки:
- all-events/[userId]
- organized-events/[userId]
- participated-events/[userId]
- shared-events/[userId]

### Карта:
- map (общая карта)
- map (персональная карта)

### Другие:
- calendar
- event-profile/[id]
- saved
- inbox
- create

---

## 8. СПРАВОЧНИК СУЩНОСТЕЙ (для копирования)

- EventCard
- MemoryPost
- EventProfile (использует те же признаки, что и EventCard)

---

**ПРИМЕЧАНИЕ:** Заполните матрицу в разделе 5, используя справочники из разделов 6, 7 и 8.

## 5. ЗАПОЛНЕННАЯ МАТРИЦА ОТНОШЕНИЙ


СТРАНИЦА/РАЗДЕЛ	СУЩНОСТЬ	ПРИЗНАКИ	ПРИМЕЧАНИЯ
explore (глобальная лента)	EventCard	предстоящее, не_заполнено, я_не_член, не_друг_организатора	Исключаются: отменено, я_отклонил_приглашение, я_отклонил_запрос, удалено, прошедшее
explore (лента друзей)	EventCard	предстоящее, не_заполнено, друг_организатора, я_не_член, я_приглашен	Исключаются: отменено, я_отклонил_приглашение, я_отклонил_запрос, удалено
memories (лента меморис постов)	MemoryPost	прошедшее, автор_поста_я, автор_поста_друг, АВТОР_ПОСТА_УЧАСТНИК_НАШЕГО_РАЗДЕЛЕННОГО_СОБЫТИЯ (то есть мы можем быть не_друзьями, но быть членами одного события)	Исключаются: автор_поста_не_участвовал_в_событиях_где_я_член
profile (свой профиль) - раздел "Memories"	EventCard	прошедшее, я_член_события	Прошедшие события, где пользователь организатор или принятый участник. Исключаются предстоящие
profile (свой и чужой профиль) - раздел "Организатор»	EventCard	предстоящее, я_организатор	Исключаются: отменено, удалено, я_участник, прошедшее
profile (свой и чужой профиль) - раздел "Участник»	EventCard	предстоящее, я_участник	Исключаются: отменено, удалено, я_организатор, прошедшее
profile (свой и чужой профиль) - параметр "всего событий" (шапка)	счетчик+ список внутри с EventCard-ами	предстоящее, прошедшее, я_организатор, я_участник (свои для каждого userId)	Считает все события, где пользователь организатор или принятый участник. Исключаются: отменено, удалено, отменил участие
profile (свой и чужой профиль) - параметр "организовал" (шапка)	счетчик+ список внутри с EventCard-ами	предстоящее, прошедшее, я_организатор (свои для каждого userId)	Только события, где пользователь организатор. Исключаются: отменено, удалено, отменил участие (если участников >= 2)
profile (свой и чужой профиль) - параметр "участвовал" (шапка)	счетчик+ список внутри с EventCard-ами	предстоящее, прошедшее, я_участник (свои для каждого userId)	Исключаются: отменено, удалено, отменил участие
profile (чужой профиль) - параметр "разделенные» )(shared) (шапка)	счетчик + список внутри с EventCard-ами	предстоящее, прошедшее, я_член_события (свои для каждого userId)	
map (общая карта)	EventCard (маркер)	предстоящее, не_заполнено, я_не_член, не_друг_организатора	
map (карта ленты друзей)	EventCard (маркер)	предстоящее, не_заполнено, друг_организатора, я_не_член, я_приглашен	
map (персональная карта)	EventCard (маркер)	предстоящее, прошедшее, я_член_события	Все События, где пользователь организатор или участник
calendar	EventCard (маркер в месячной раскладке)	Все времена, я_член_события, я_приглашен (фиолетовое обрамление кружочка с фото (меркера)), я_запросил_участие (оранжевое обрамление кружочка с фото (маркера))	События текущей недели, где пользователь член
calendar	EventCard (запись в недельной раскладке)	Все времена, я_член_события, я_приглашен (кнопка принять приглашение), я_запросил_участие (значок ожидания)	
event-profile/[id]	EventCard (как шапка профиля события) 	Профиль события всегда повторяет признаки и состояния карточки события	
event-profile/[id]	MemoryPost	Выкладывают только члены события (событие=карточка + профиль). MemoryPost-ы можно выкладывать в любое время, даже если событие еще предстоящее.	
saved	EventCard / MemoryPost	Любые состояния (для EventCard), любые (для MemoryPost), сохранено_пользователем	Сохраненные пользователем события и посты
inbox	EventCard	pending, invited, я_приглашен, я_запросил_участие	Мини-иконка в запросе или уведомлении ведущая на профиль этого события. 
create	-	-	Форма создания события
Ключевые уточнения:
1. EventProfile - это не отдельная сущность с признаками, а просто страница-композиция из EventCard (шапка) и MemoryPost (лента ниже). Поэтому EventProfile наследует все признаки EventCard.
2. Исключения в лентах explore:
    * Глобальная лента: исключаются события, которые пользователь отклонил (как приглашение, так и если отклонили мой запрос)
