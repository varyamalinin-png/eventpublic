# üîß –ö–†–ò–¢–ò–ß–ï–°–ö–û–ï –ò–°–ü–†–ê–í–õ–ï–ù–ò–ï

## ‚ùå –ü—Ä–æ–±–ª–µ–º–∞

–ù–∞ —Å–µ—Ä–≤–µ—Ä–µ Railway –∑–∞–ø—É—â–µ–Ω–∞ **–°–¢–ê–†–ê–Ø –≤–µ—Ä—Å–∏—è** –∫–æ–¥–∞, –∫–æ—Ç–æ—Ä–∞—è:
1. –ü—ã—Ç–∞–µ—Ç—Å—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å **Mailgun** (Account disabled)
2. –ü—ã—Ç–∞–µ—Ç—Å—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å **SMTP** (Connection timeout)
3. –ò—Å–ø–æ–ª—å–∑—É–µ—Ç `fetch` –∫–æ—Ç–æ—Ä—ã–π –ø–∞–¥–∞–µ—Ç —Å "fetch failed"

–í –ª–æ–≥–∞—Ö –≤–∏–¥–Ω–æ:
```
[MailerService] üîç Mailgun check: enabled=true
[MailerService] ‚úÖ Using Mailgun API
[MailerService] [SMTP] Using SMTP
[MailerService] ‚ùå Yandex Cloud error: fetch failed
```

## ‚úÖ –ß—Ç–æ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–æ

1. **–£–¥–∞–ª–µ–Ω –≤–µ—Å—å –∫–æ–¥ Mailgun/SMTP** - —Ç–æ–ª—å–∫–æ Yandex Cloud Email API
2. **–ó–∞–º–µ–Ω–µ–Ω `fetch` –Ω–∞ `https` –º–æ–¥—É–ª—å** - —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å —Å Node.js
3. **–£–ª—É—á—à–µ–Ω–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫** - –¥–µ—Ç–∞–ª—å–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ

## üöÄ –ß—Ç–æ –Ω—É–∂–Ω–æ —Å–¥–µ–ª–∞—Ç—å

### –®–∞–≥ 1: –ó–∞–¥–µ–ø–ª–æ–∏—Ç—å –Ω–æ–≤—É—é –≤–µ—Ä—Å–∏—é –Ω–∞ Railway

**–í–ê–ñ–ù–û**: Railway –º–æ–∂–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –∫–µ—à–∏—Ä–æ–≤–∞–Ω–Ω—É—é –≤–µ—Ä—Å–∏—é! –ù—É–∂–Ω–æ:

1. –ó–∞–π—Ç–∏ –≤ Railway Dashboard
2. –í—ã–±—Ä–∞—Ç—å –≤–∞—à –ø—Ä–æ–µ–∫—Ç
3. Settings ‚Üí Build
4. **–û—á–∏—Å—Ç–∏—Ç—å Build Cache** (Clear Build Cache)
5. –ù–∞–∂–∞—Ç—å **Redeploy**

### –®–∞–≥ 2: –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è

–£–±–µ–¥–∏—Ç–µ—Å—å —á—Ç–æ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ã:
- `YANDEX_IAM_TOKEN` - IAM —Ç–æ–∫–µ–Ω (–¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª–µ–Ω 12 —á–∞—Å–æ–≤!)
- `YANDEX_CLOUD_FROM_EMAIL` - noreply@iventapp.ru
- `YANDEX_CLOUD_API_ENDPOINT` - https://mail-api.cloud.yandex.net (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)

### –®–∞–≥ 3: –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ª–æ–≥–∏ –ø–æ—Å–ª–µ –¥–µ–ø–ª–æ—è

**–î–æ–ª–∂–Ω–æ –±—ã—Ç—å:**
```
‚úÖ Yandex Cloud Email API enabled (from: noreply@iventapp.ru)
[MailerService] ‚úÖ Using Yandex Cloud Email API to send email to ...
```

**–ù–ï –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å:**
- ‚ùå "Mailgun check"
- ‚ùå "Using Mailgun API"
- ‚ùå "Using SMTP"
- ‚ùå "fetch failed"

## üîç –ö–∞–∫ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ –Ω–æ–≤–∞—è –≤–µ—Ä—Å–∏—è –∑–∞–¥–µ–ø–ª–æ–µ–Ω–∞

–ü–æ—Å–ª–µ –¥–µ–ø–ª–æ—è –ø–æ–ø—Ä–æ–±—É–π—Ç–µ –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞—Ç—å—Å—è - –≤ –ª–æ–≥–∞—Ö –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å –¢–û–õ–¨–ö–û —Å–æ–æ–±—â–µ–Ω–∏—è –æ Yandex Cloud, –±–µ–∑ Mailgun/SMTP.

## ‚ö†Ô∏è –í–∞–∂–Ω–æ

**IAM —Ç–æ–∫–µ–Ω –∏—Å—Ç–µ–∫–∞–µ—Ç —á–µ—Ä–µ–∑ 12 —á–∞—Å–æ–≤!** –ï—Å–ª–∏ –ø–∏—Å—å–º–∞ –Ω–µ –æ—Ç–ø—Ä–∞–≤–ª—è—é—Ç—Å—è, –æ–±–Ω–æ–≤–∏—Ç–µ —Ç–æ–∫–µ–Ω:
```bash
cd server && node scripts/get-yandex-iam-token.js
```

–ó–∞—Ç–µ–º —É—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –Ω–æ–≤—ã–π —Ç–æ–∫–µ–Ω –≤ Railway –∫–∞–∫ `YANDEX_IAM_TOKEN` –∏ **–ø–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç–µ —Å–µ—Ä–≤–∏—Å**.

