# ‚úÖ Email API –æ–∫–æ–Ω—á–∞—Ç–µ–ª—å–Ω–æ –Ω–∞—Å—Ç—Ä–æ–µ–Ω

## ‚úÖ –ß—Ç–æ —Å–¥–µ–ª–∞–Ω–æ

1. ‚úÖ –ü–æ–ª—É—á–µ–Ω IAM —Ç–æ–∫–µ–Ω —á–µ—Ä–µ–∑ `yc iam create-token`
2. ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω `YANDEX_IAM_TOKEN` –≤ `.env` —Ñ–∞–π–ª –Ω–∞ VM
3. ‚úÖ –°–æ–∑–¥–∞–Ω `ecosystem.config.js` –¥–ª—è PM2 —Å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–π –∑–∞–≥—Ä—É–∑–∫–æ–π –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –∏–∑ `.env`
4. ‚úÖ –ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –ø–µ—Ä–µ–∑–∞–ø—É—â–µ–Ω–æ —Å –ø—Ä–∞–≤–∏–ª—å–Ω—ã–º–∏ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–º–∏ –æ–∫—Ä—É–∂–µ–Ω–∏—è

## üìß –ù–∞—Å—Ç—Ä–æ–π–∫–∏ Email API

- **–î–æ–º–µ–Ω**: `iventapp.ru`
- **–û—Ç–ø—Ä–∞–≤–∏—Ç–µ–ª—å**: `noreply@iventapp.ru`
- **DKIM**: –ù–∞—Å—Ç—Ä–æ–µ–Ω (–∑–∞–ø–∏—Å—å `postbox._domainkey.iventapp.ru`)
- **API Endpoint**: `https://mail-api.cloud.yandex.net`
- **IAM Token**: –£—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω –≤ `.env`

## üîç –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–±–æ—Ç—ã

### –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ç–æ–∫–µ–Ω–∞ –≤ .env:
```bash
ssh -i ~/.ssh/yandex-cloud ubuntu@89.169.173.152
cd ~/event_app_new/server
grep YANDEX_IAM_TOKEN .env
```

### –ü—Ä–æ–≤–µ—Ä–∫–∞ –ª–æ–≥–æ–≤ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è:
```bash
pm2 logs event-app | grep -i 'mail\|email\|yandex'
```

–î–æ–ª–∂–Ω–æ –±—ã—Ç—å —Å–æ–æ–±—â–µ–Ω–∏–µ:
```
‚úÖ Yandex Cloud Email API enabled (from: noreply@iventapp.ru)
```

### –¢–µ—Å—Ç –æ—Ç–ø—Ä–∞–≤–∫–∏ –ø–∏—Å—å–º–∞:
–ü–æ–ø—Ä–æ–±—É–π—Ç–µ –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞—Ç—å—Å—è –≤ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏ - –ø–∏—Å—å–º–æ –¥–æ–ª–∂–Ω–æ –ø—Ä–∏–π—Ç–∏ –Ω–∞ —É–∫–∞–∑–∞–Ω–Ω—ã–π email.

## ‚ö†Ô∏è –í–∞–∂–Ω–æ: –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Ç–æ–∫–µ–Ω–∞

IAM —Ç–æ–∫–µ–Ω—ã –∏—Å—Ç–µ–∫–∞—é—Ç —á–µ—Ä–µ–∑ 12 —á–∞—Å–æ–≤. –î–ª—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è:

```bash
# –ù–∞ –≤–∞—à–µ–º –ª–æ–∫–∞–ª—å–Ω–æ–º –∫–æ–º–ø—å—é—Ç–µ—Ä–µ
NEW_TOKEN=$(yc iam create-token)

# –ù–∞ VM
ssh -i ~/.ssh/yandex-cloud ubuntu@89.169.173.152
cd ~/event_app_new/server
sed -i "s|^YANDEX_IAM_TOKEN=.*|YANDEX_IAM_TOKEN=$NEW_TOKEN|" .env
pm2 restart event-app
```

## üîÑ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Ç–æ–∫–µ–Ω–∞ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)

–î–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è —Ç–æ–∫–µ–Ω–∞ –º–æ–∂–Ω–æ —Å–æ–∑–¥–∞—Ç—å cron job –∏–ª–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å service account —Å –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω–Ω—ã–º –∫–ª—é—á–æ–º.

## ‚úÖ –ì–æ—Ç–æ–≤–æ!

Email API –Ω–∞—Å—Ç—Ä–æ–µ–Ω –∏ –≥–æ—Ç–æ–≤ –∫ —Ä–∞–±–æ—Ç–µ. –ü–∏—Å—å–º–∞ –±—É–¥—É—Ç –æ—Ç–ø—Ä–∞–≤–ª—è—Ç—å—Å—è —á–µ—Ä–µ–∑ Yandex Cloud Email API —Å –∞–¥—Ä–µ—Å–∞ `noreply@iventapp.ru`.

**IP –∞–¥—Ä–µ—Å**: `89.169.173.152:4000`

