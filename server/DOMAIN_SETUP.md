# üåê –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –¥–æ–º–µ–Ω–∞ iventapp.ru —Å SSL

## üìã –ß—Ç–æ –Ω—É–∂–Ω–æ —Å–¥–µ–ª–∞—Ç—å

### 1. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ DNS –∑–∞–ø–∏—Å–µ–π

–í –ø–∞–Ω–µ–ª–∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –≤–∞—à–µ–≥–æ DNS –ø—Ä–æ–≤–∞–π–¥–µ—Ä–∞ (–≥–¥–µ –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω –¥–æ–º–µ–Ω `iventapp.ru`) –Ω—É–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å —Å–ª–µ–¥—É—é—â–∏–µ –∑–∞–ø–∏—Å–∏:

#### A –∑–∞–ø–∏—Å—å (–æ—Å–Ω–æ–≤–Ω–∞—è):
- **–¢–∏–ø**: A
- **–ò–º—è**: @ (–∏–ª–∏ –ø—É—Å—Ç–æ–µ, –∏–ª–∏ iventapp.ru)
- **–ó–Ω–∞—á–µ–Ω–∏–µ**: `89.169.173.152`
- **TTL**: 3600 (–∏–ª–∏ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é)

#### A –∑–∞–ø–∏—Å—å –¥–ª—è www:
- **–¢–∏–ø**: A
- **–ò–º—è**: www
- **–ó–Ω–∞—á–µ–Ω–∏–µ**: `89.169.173.152`
- **TTL**: 3600 (–∏–ª–∏ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é)

### 2. –ü—Ä–æ–≤–µ—Ä–∫–∞ DNS

–ü–æ—Å–ª–µ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –∑–∞–ø–∏—Å–µ–π –ø–æ–¥–æ–∂–¥–∏—Ç–µ 5-10 –º–∏–Ω—É—Ç –∏ –ø—Ä–æ–≤–µ—Ä—å—Ç–µ:

```bash
# –ü—Ä–æ–≤–µ—Ä–∫–∞ A –∑–∞–ø–∏—Å–∏
dig iventapp.ru +short
# –î–æ–ª–∂–Ω–æ –≤–µ—Ä–Ω—É—Ç—å: 89.169.173.152

# –ü—Ä–æ–≤–µ—Ä–∫–∞ www
dig www.iventapp.ru +short
# –î–æ–ª–∂–Ω–æ –≤–µ—Ä–Ω—É—Ç—å: 89.169.173.152
```

### 3. –ü–æ–ª—É—á–µ–Ω–∏–µ SSL —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–∞

–ü–æ—Å–ª–µ —Ç–æ–≥–æ, –∫–∞–∫ DNS –∑–∞–ø–∏—Å–∏ –ø—Ä–∏–º–µ–Ω—è—Ç—Å—è, –≤—ã–ø–æ–ª–Ω–∏—Ç–µ –Ω–∞ VM:

```bash
ssh -i ~/.ssh/yandex-cloud ubuntu@89.169.173.152
sudo certbot --nginx -d iventapp.ru -d www.iventapp.ru
```

Certbot –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏:
- –ü–æ–ª—É—á–∏—Ç SSL —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç –æ—Ç Let's Encrypt
- –ù–∞—Å—Ç—Ä–æ–∏—Ç nginx –¥–ª—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è HTTPS
- –ù–∞—Å—Ç—Ä–æ–∏—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–∞

### 4. –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è

–ü–æ—Å–ª–µ –ø–æ–ª—É—á–µ–Ω–∏—è SSL —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–∞ –Ω—É–∂–Ω–æ –æ–±–Ω–æ–≤–∏—Ç—å `.env` –Ω–∞ VM:

```bash
ssh -i ~/.ssh/yandex-cloud ubuntu@89.169.173.152
cd ~/event_app_new/server
nano .env
```

–û–±–Ω–æ–≤–∏—Ç–µ —Å–ª–µ–¥—É—é—â–∏–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ:
```env
APP_BACKEND_BASE_URL=https://iventapp.ru
APP_FRONTEND_BASE_URL=https://iventapp.ru
APP_URL=https://iventapp.ru
EMAIL_VERIFICATION_REDIRECT_URL=https://iventapp.ru/auth/verify
PASSWORD_RESET_REDIRECT_URL=https://iventapp.ru/auth/reset
```

–ó–∞—Ç–µ–º –ø–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ:
```bash
pm2 restart event-app
```

### 5. –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –º–æ–±–∏–ª—å–Ω–æ–≥–æ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è

–ü–æ—Å–ª–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ SSL –æ–±–Ω–æ–≤–∏—Ç–µ `client/app.json`:

```json
"apiUrl": "https://iventapp.ru"
```

–ò –ø–µ—Ä–µ—Å–æ–±–µ—Ä–∏—Ç–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –≤ Xcode.

## ‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞

–ü–æ—Å–ª–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –ø—Ä–æ–≤–µ—Ä—å—Ç–µ:

1. **HTTPS —Ä–∞–±–æ—Ç–∞–µ—Ç:**
   ```bash
   curl -I https://iventapp.ru
   ```

2. **API –æ—Ç–≤–µ—á–∞–µ—Ç:**
   ```bash
   curl https://iventapp.ru/api/auth/check-email-status
   ```

3. **SSL —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç –≤–∞–ª–∏–¥–µ–Ω:**
   –û—Ç–∫—Ä–æ–π—Ç–µ https://iventapp.ru –≤ –±—Ä–∞—É–∑–µ—Ä–µ –∏ –ø—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ –Ω–µ—Ç –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–π –æ —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–µ

## üîÑ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ SSL

Certbot –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –Ω–∞—Å—Ç—Ä–æ–∏—Ç –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–∞ —á–µ—Ä–µ–∑ cron. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –º–æ–∂–Ω–æ:

```bash
sudo certbot renew --dry-run
```

## üõ°Ô∏è –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

–ü–æ—Å–ª–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ SSL —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è:

1. **–ó–∞–∫—Ä—ã—Ç—å –ø–æ—Ä—Ç 4000** –≤ Security Groups (–æ—Å—Ç–∞–≤–∏—Ç—å —Ç–æ–ª—å–∫–æ 80 –∏ 443)
2. **–ù–∞—Å—Ç—Ä–æ–∏—Ç—å firewall –Ω–∞ VM:**
   ```bash
   sudo ufw allow 80/tcp
   sudo ufw allow 443/tcp
   sudo ufw deny 4000/tcp
   ```

## üì± –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –º–æ–±–∏–ª—å–Ω–æ–≥–æ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è

–ü–æ—Å–ª–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –¥–æ–º–µ–Ω–∞ –æ–±–Ω–æ–≤–∏—Ç–µ `client/app.json`:

```json
"apiUrl": "https://iventapp.ru"
```

–ò –ø–µ—Ä–µ—Å–æ–±–µ—Ä–∏—Ç–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ.

## ‚ö†Ô∏è –í–∞–∂–Ω–æ

1. **DNS –∑–∞–ø–∏—Å–∏ –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å –ø—Ä–∏–º–µ–Ω–µ–Ω—ã** –ø–µ—Ä–µ–¥ –ø–æ–ª—É—á–µ–Ω–∏–µ–º SSL —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–∞
2. **–ü–æ–¥–æ–∂–¥–∏—Ç–µ 5-10 –º–∏–Ω—É—Ç** –ø–æ—Å–ª–µ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è DNS –∑–∞–ø–∏—Å–µ–π
3. **–ü—Ä–æ–≤–µ—Ä—å—Ç–µ DNS** –ø–µ—Ä–µ–¥ –∑–∞–ø—É—Å–∫–æ–º certbot

