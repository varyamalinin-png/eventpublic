# План рефакторинга проекта

## Анализ больших файлов

### 1. `profile.tsx` (1991 строка)
**Проблемы:**
- Слишком много ответственности в одном компоненте
- 2 модальных окна внутри компонента (AddToFolderModal, CreateFolderModal)
- Множество useMemo для фильтрации событий (можно вынести в хуки)
- Огромный блок стилей (490+ строк)
- Сложная логика фильтрации событий

**План рефакторинга:**
1. Вынести модальные окна в отдельные компоненты:
   - `components/AddToFolderModal.tsx`
   - `components/CreateFolderModal.tsx`
2. Создать кастомные хуки для фильтрации событий:
   - `hooks/profile/useProfileEvents.ts` - все useMemo для событий
   - `hooks/profile/useProfileState.ts` - управление состоянием профиля
3. Вынести утилиты:
   - `utils/profile/eventFilters.ts` - функции фильтрации
4. Разделить стили:
   - `styles/profileStyles.ts` или оставить в файле, но структурировать

### 2. `EventCard.tsx` (3447 строк)
**Проблемы:**
- Огромный компонент с множеством вариантов отображения
- Много условной логики
- Большой блок стилей

**План рефакторинга:**
1. Разделить на подкомпоненты:
   - `EventCard/EventCardDefault.tsx` - основной вариант
   - `EventCard/EventCardMiniature.tsx` - миниатюрные варианты
   - `EventCard/EventCardChatPreview.tsx` - превью для чата
   - `EventCard/EventCardSwipeActions.tsx` - действия свайпа
2. Вынести логику:
   - `hooks/events/useEventCardActions.ts` - действия с событием
   - `hooks/events/useEventCardSwipe.ts` - логика свайпа
3. Вынести стили:
   - `styles/eventCardStyles.ts`

### 3. `create.tsx` (3282 строки)
**Проблемы:**
- Аналогично profile.tsx - много ответственности
- Вероятно, много модальных окон и форм

**План рефакторинга:**
- Аналогично profile.tsx
- Вынести формы создания события
- Вынести модальные окна
- Создать хуки для управления состоянием

## Приоритеты

1. **Высокий приоритет:** `profile.tsx` - самый часто используемый компонент ✅ **В ПРОЦЕССЕ**
2. **Средний приоритет:** `EventCard.tsx` - используется везде, но сложнее рефакторить
3. **Низкий приоритет:** `create.tsx` - используется реже

## Подход к рефакторингу

1. ✅ **Вынос модальных окон** (низкий риск) - **ЗАВЕРШЕНО**
   - Созданы `AddToFolderModal.tsx` и `CreateFolderModal.tsx`
   - Удалены дублирующиеся модальные окна
   - Удалены неиспользуемые стили (143 строки)
   - **Результат:** `profile.tsx` уменьшился с 1991 до 1675 строк (-316 строк, -16%)

2. **Вынос хуков** (средний риск) - **СЛЕДУЮЩИЙ ШАГ**
   - Создать `hooks/profile/useProfileEvents.ts` для всех useMemo фильтрации
   - Создать `hooks/profile/useProfileState.ts` для управления состоянием
   - Ожидаемое уменьшение: ~200-300 строк

3. **Разделение компонентов** (высокий риск, требует тестирования)
   - Вынести секции профиля в отдельные компоненты
   - Ожидаемое уменьшение: ~300-400 строк

## Прогресс

- ✅ Модальные окна вынесены
- ⏳ Хуки для фильтрации событий (следующий шаг)
- ⏳ Разделение на подкомпоненты
