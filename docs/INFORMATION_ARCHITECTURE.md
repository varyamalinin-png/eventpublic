# Информационная архитектура приложения Event App

## Общая структура приложения

Приложение построено на Expo Router с разделением на:
- **Мобильная версия** (React Native для iOS/Android)
- **Веб-версия** (Next.js с React Native Web)

---

## 1. Аутентификация и регистрация (`/app/(auth)/`)

### Экраны
- **`/login`** - Экран входа и регистрации
  - Переключение между режимами "Вход" и "Регистрация"
  - Валидация email и пароля
  - Подтверждение email через `/verify-email`

- **`/verify-email`** - Подтверждение email адреса
  - Ввод кода подтверждения
  - Перенаправление в приложение после подтверждения

### Состояние
- Неавторизованный пользователь → видит только экраны аутентификации
- Авторизованный пользователь → доступ ко всем разделам приложения

---

## 2. Основная навигация (Tab Navigation) - `/(tabs)/`

### 2.1. **Explore** - Глобальная лента событий
- **Путь**: `/(tabs)/explore`
- **Описание**: Лента всех публичных событий
- **Функциональность**:
  - Просмотр списка событий (карточки)
  - Фильтрация по категориям/типам
  - Режим "Все" и "Друзья"
  - Поиск событий
  - Переход к детальному просмотру события

### 2.2. **Memories** - Лента меморис-постов
- **Путь**: `/(tabs)/memories`
- **Описание**: Лента постов о прошедших событиях
- **Функциональность**:
  - Просмотр постов от участников событий
  - Просмотр фотографий и описаний
  - Переход к детальному просмотру поста

### 2.3. **Create** - Создание события (только мобильная версия)
- **Путь**: `/(tabs)/create`
- **Описание**: Форма создания нового события
- **Функциональность**:
  - Заполнение данных события (название, описание, дата, место)
  - Выбор категории
  - Загрузка изображения
  - Выбор места на карте
  - Настройка приватности

### 2.4. **Inbox** - Сообщения и уведомления
- **Путь**: `/(tabs)/inbox`
- **Подразделы**:
  - **`/inbox`** - Список чатов
    - Список всех чатов пользователя
    - Непрочитанные сообщения (badge)
    - Поиск чатов
  - **`/inbox/[chatId]`** - Детальный просмотр чата
    - История сообщений
    - Отправка сообщений
    - Информация о собеседнике
  - **`/inbox/messages`** - Все сообщения (общий список)
  - **`/inbox/requests`** - Запросы на дружбу и участия в событиях

### 2.5. **Profile** - Профиль пользователя (только мобильная версия)
- **Путь**: `/(tabs)/profile`
- **Описание**: Свой профиль пользователя
- **Функциональность**:
  - Просмотр своих данных
  - Редактирование профиля (через Settings)
  - Просмотр своих событий (все, организованные, участия)
  - Раздел "Memories" (прошедшие события)
  - Счетчики событий в шапке:
    - Всего событий
    - Организовал
    - Участвовал
    - Разделил

### 2.6. **Saved** - Сохраненные события (скрыт в табах)
- **Путь**: `/(tabs)/saved`
- **Описание**: Список сохраненных событий
- **Доступ**: Через настройки профиля

---

## 3. События (Events)

### 3.1. **Детальный просмотр события**
- **Путь**: `/event-profile/[id]`
- **Описание**: Полная информация о событии
- **Функциональность**:
  - Информация о событии (название, описание, дата, место)
  - Список участников
  - Действия:
    - Присоединиться к событию
    - Покинуть событие
    - Редактировать (если организатор)
    - Удалить (если организатор)
    - Поделиться
    - Сохранить в избранное
    - Перейти в чат события
  - Карта с местом проведения

### 3.2. **Создание события** (веб-версия)
- **Путь**: `/create-event`
- **Описание**: Форма создания события для веб-версии

### 3.3. **Списки событий пользователя**
- **`/all-events/[userId]`** - Все события пользователя
- **`/organized-events/[userId]`** - События, которые пользователь организовал
- **`/participated-events/[userId]`** - События, где пользователь участник
- **`/shared-events/[userId]`** - События, которыми пользователь поделился

### 3.4. **Папки событий**
- **`/event-folder/[id]`** - Просмотр папки событий
- **`/event-folder-view/[id]`** - Детальный просмотр папки

### 3.5. **Мои события**
- **`/my-events`** - Все мои события (объединенный список)

---

## 4. Профили пользователей

### 4.1. **Свой профиль**
- **Путь**: `/(tabs)/profile` (мобильная) или `/profile/[id]` где id = текущий пользователь
- **Описание**: Собственный профиль пользователя

### 4.2. **Профиль другого пользователя**
- **Путь**: `/profile/[id]`
- **Описание**: Просмотр профиля другого пользователя
- **Функциональность**:
  - Информация о пользователе
  - Список событий пользователя
  - Раздел "Memories"
  - Действия:
    - Добавить в друзья / Удалить из друзей
    - Перейти к списку событий
    - Просмотр организованных событий
    - Просмотр событий участия
  - Режим ленты событий (при клике на карточку события)

---

## 5. Друзья

### 5.1. **Список друзей**
- **Путь**: `/friends-list`
- **Описание**: Список всех друзей текущего пользователя
- **Функциональность**:
  - Просмотр списка друзей
  - Поиск по друзьям
  - Переход к профилю друга

### 5.2. **Список друзей пользователя**
- **Путь**: `/friends-list/[id]`
- **Описание**: Список друзей конкретного пользователя

---

## 6. Дополнительные функции

### 6.1. **Карта событий**
- **Путь**: `/map`
- **Описание**: Интерактивная карта с отмеченными событиями
- **Функциональность**:
  - Отображение событий на карте (Yandex Maps)
  - Клик на маркер → переход к событию
  - Фильтрация по категориям

### 6.2. **Календарь**
- **Путь**: `/calendar`
- **Описание**: Календарное представление событий
- **Функциональность**:
  - Просмотр событий по дням
  - Переход к событию при клике

### 6.3. **Настройки**
- **Путь**: `/settings`
- **Описание**: Настройки профиля и приложения
- **Функциональность**:
  - Редактирование профиля (имя, email, аватар)
  - Смена пароля
  - Настройки уведомлений
  - Язык интерфейса
  - Выход из аккаунта
  - Доступ к сохраненным событиям

### 6.4. **Множественные аккаунты**
- **`/add-account`** - Добавление второго аккаунта
  - Режимы: login / register
  - Переключение между аккаунтами
- **`/add-account-verify`** - Подтверждение второго аккаунта

### 6.5. **Оплата**
- **Путь**: `/payment`
- **Описание**: Система оплаты (для платных событий?)

---

## 7. Административные функции

### 7.1. **Админ-панель**
- **Путь**: `/admin/index`
- **Описание**: Главная страница администратора

### 7.2. **Жалобы**
- **Путь**: `/admin/complaints`
- **Описание**: Управление жалобами пользователей
- **Путь**: `/support/complaints` - Создание жалобы
- **Путь**: `/my-complaints` - Мои жалобы

---

## 8. Меморис-посты

### 8.1. **Детальный просмотр поста**
- **Путь**: `/memory-post/[eventId]/[postId]`
- **Описание**: Полная информация о меморис-посте
- **Функциональность**:
  - Просмотр фотографий
  - Описание от автора
  - Информация о событии
  - Лайки и комментарии (если реализовано)

---

## 9. Утилиты

### 9.1. **Выбор локации**
- **Путь**: `/select-location`
- **Описание**: Выбор места на карте (при создании события)

---

## 10. Состояния и данные

### Контексты
- **`AuthContext`** - Аутентификация пользователя
  - Состояние авторизации
  - Информация о пользователе
  - Токены (access, refresh)
  - Множественные аккаунты

- **`EventsContext`** - Управление событиями
  - Список событий
  - Список чатов
  - Уведомления
  - Запросы на участие
  - Запросы на дружбу

- **`LanguageContext`** - Языковые настройки
  - Текущий язык интерфейса
  - Переключение языков

---

## Навигационная структура

```
┌─────────────────────────────────────────┐
│         Entry Point (index)             │
└─────────────────┬───────────────────────┘
                  │
        ┌─────────┴─────────┐
        │                   │
   Authenticated      Unauthenticated
        │                   │
        │              ┌────┴────┐
        │              │ (auth)  │
        │              │ -login  │
        │              │ -verify │
        │              └─────────┘
        │
┌───────┴────────────────────────────┐
│         (tabs) - Tab Navigation    │
├────────────────────────────────────┤
│ • explore    - Глобальная лента    │
│ • memories   - Меморис посты       │
│ • create     - Создание (mobile)   │
│ • inbox      - Сообщения           │
│ • profile    - Профиль (mobile)    │
│ • saved      - Сохраненные         │
└────────────────────────────────────┘
        │
        ├─ settings          - Настройки
        ├─ calendar          - Календарь
        ├─ map               - Карта
        ├─ profile/[id]      - Профиль пользователя
        ├─ event-profile/[id] - Детали события
        ├─ friends-list      - Друзья
        ├─ add-account       - Множественные аккаунты
        ├─ payment           - Оплата
        ├─ admin/*           - Админ панель
        └─ ...               - Другие экраны
```

---

## Платформенные различия

### Мобильная версия
- Нижняя таб-навигация
- Все экраны доступны в табах
- Нативная навигация (Expo Router)

### Веб-версия
- Explore, Memories, Inbox в табах
- Profile и Create доступны через меню
- Next.js роутинг

---

## Примечания

1. **Режим ленты событий**: При клике на карточку события в профиле открывается режим ленты событий этого пользователя (аналог explore, но для конкретного пользователя).

2. **Локальное состояние**: На вебе используется локальное состояние для режима ленты событий вместо URL параметров.

3. **Синхронизация**: События синхронизируются с сервером через `syncEventsFromServer()` после локальных изменений.

4. **Удаление событий**: При удалении события оно удаляется из всех связанных списков (организованные, участия, счетчики в профиле).
